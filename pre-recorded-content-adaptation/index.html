<!DOCTYPE html>
<html lang="en">
  <head>
    <title>TRACTION Toolset</title>
    <link rel="icon" type="image/x-icon" href="https://traction-project.github.io/images/logo.png">

    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport" />

    <script src="https://traction-project.github.io/scripts/navbar_menu.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="stylesheet" href="https://traction-project.github.io/styles/style.css" />
  </head>
  <body>
    





<nav class="navbar is-dark" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://traction-project.github.io/">
      <img src="https://traction-project.github.io/images/menu_logo.png">
    </a>

    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      <a class="navbar-item " href="https://traction-project.github.io/">
        Home
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link ">
          Co-Creation Space
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://traction-project.github.io/co-creation-space">
            Co-Creation Space
          </a>
          <a class="navbar-item" href="https://traction-project.github.io/face-and-object-recognition">
            Face and Object Recognition
          </a>
        </div>
      </div>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link is-active">
          Co-Creation Stage
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://traction-project.github.io/co-creation-stage">
            Co-Creation Stage
          </a>
          <a class="navbar-item" href="https://traction-project.github.io/encoding-api">
            Encoding API for Co-Creation Stage
          </a>
          <a class="navbar-item" href="https://traction-project.github.io/pre-recorded-content-adaptation">
            Pre-Recorded Content Adaptation
          </a>
          <a class="navbar-item" href="https://traction-project.github.io/live-content-adaptation">
            Live Content Adaptation
          </a>
        </div>
      </div>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link ">
          Immersive Experiences
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://traction-project.github.io/social-vr">
            Social VR
          </a>
          <a class="navbar-item" href="https://traction-project.github.io/immersive-adaptive-player">
            Immsersive Adaptive Player
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>


    

    <section class="section">
      <div class="container">
        
          <nav class="breadcrumb" aria-label="breadcrumbs">
            <ul>
              <li><a href="/">Home</a></li>
              <li class="is-active"><a href="#" aria-current="page">Pre-Recorded Content Adaptation</a></li>
            </ul>
          </nav>
        

        
  <h2 class="title is-2">Pre-Recorded Content Adaptation</h2>

  <hr/>

  <div class="columns">
    <div class="column is-4">
      <h4 class="title is-4">Table of Contents</h4>

      <div class="content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#description">Description</a></li>
    <li><a href="#deployment">Deployment</a>
      <ul>
        <li><a href="#setup">Setup</a></li>
        <li><a href="#data-collection">Data Collection</a></li>
        <li><a href="#adding-modifying-the-pre-recorded-content-adaptation-algorithm">Adding/ modifying the Pre-Recorded Content Adaptation Algorithm</a></li>
        <li><a href="#dashjs-documentation">dash.js Documentation</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>

      
        <div class="block">
          <a href="https://github.com/traction-project/PreRecordedContentAdaptation" target="_blank" class="button">
            <span class="icon">
              <i class="fab fa-github"></i>
            </span>
            <span>GitHub Repository</span>
          </a>
        </div>
      
    </div>
    <div class="column is-4">
      <h4 class="title is-4">Contact</h4>
      <div class="block">
        
  
    
    
    Please contact <a href="mailto:mohammedamine.togou@dcu.ie">Mohammed Togou</a> or <a href="mailto:gabriel.muntean@dcu.ie">Gabriel Muntean</a> for more information about this tool.
  


      </div>
      <h4 class="title is-4">License</h4>
      <div class="block">
        
          All code and documentation is licensed by the original authors and contributors under the
          <a href="https://github.com/traction-project/PreRecordedContentAdaptation/blob/master/LICENSE.md">BSD license</a>.
        
      </div>
    </div>
    
  </div>

  <hr/>

  <div class="content">
    <h2 id="description">Description</h2>
<p>The Pre-Recorded Content Adaptation solution contains a DASH-based 2D web player and a novel audio-prioritised adaptation solution for 2D content streaming.</p>
<p>The Pre-Recorded Content Adaptation Algorithm for the TRACTION EU-project is used to select the appropriate bitrates during on-demand content streaming to guarantee viewersâ€™ good QoE. It considers differents parameters such as bandwidth, buffer level, quality variation, and stream priority. It tries to ensure the highest bitrate for audio, a key feature for performing arts pieces (opera in particular), while adapting the video quality given the bandwidth constraints. This is because many studies have shown that ensuring high audio quality can have a positive impact on viewers&rsquo; QoE.</p>
<h2 id="deployment">Deployment</h2>
<h3 id="setup">Setup</h3>
<p>The TRACTION Pre Recorded Content Adaptation Algorithm is deployed within the <!-- raw HTML omitted -->dash.js reference player<!-- raw HTML omitted --> under <code>/PreRecordedContentAdaptation/src/streaming/rules/abr</code>. The file containing the algorithm&rsquo;s logic is <code>PadaRule.js</code>.</p>
<p>To use the Pre-Recorded Content Adaptation Algorithm, first you need to create a video element on your html file. Make sure the controls attribute is present.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">video</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;videoPlayer&#34;</span> <span style="color:#a6e22e">controls</span>&gt;&lt;/<span style="color:#f92672">video</span>&gt;
</span></span></code></pre></div><p>Add dash.all.min.js to the end of the body.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;yourPathToDash/dash.all.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span></code></pre></div><p>Now, create a MediaPlayer and initialise it. The <code>url</code> attribute should contain the link to the mpd of your video.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://PathToYourMPD/manifest.mpd&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">player</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dashjs</span>.<span style="color:#a6e22e">MediaPlayer</span>().<span style="color:#a6e22e">create</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">player</span>.<span style="color:#a6e22e">initialize</span>(document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#videoPlayer&#34;</span>), <span style="color:#a6e22e">url</span>, <span style="color:#66d9ef">true</span>);
</span></span></code></pre></div><p>To make the player use the Pre-Recorded Content Adaptation Algorthim, Labelled as <code>abrPada</code>, you need to update the player&rsquo;s settings, particularly those related to <code>abr</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">player</span>.<span style="color:#a6e22e">updateSettings</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;abr&#39;</span><span style="color:#f92672">:</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;ABRStrategy&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;abrPada&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;priority&#39;</span>    <span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>Note that <code>priority</code> denotes the priority of the stream. It&rsquo;s mainly used for multi-streaming use cases. It has 3 values: high (3), medium (2), and low (1).</p>
<p>Once done, your html file should look like the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!doctype html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">title</span>&gt;My html&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">style</span>&gt;
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">video</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">width</span>: <span style="color:#ae81ff">640</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">height</span>: <span style="color:#ae81ff">360</span><span style="color:#66d9ef">px</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">style</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">video</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;videoPlayer&#34;</span> <span style="color:#a6e22e">controls</span>&gt;&lt;/<span style="color:#f92672">video</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;yourPathToDash/dash.all.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>            (<span style="color:#66d9ef">function</span>(){
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">url</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://PathToYourMPD/manifest.mpd&#34;</span>;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">player</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">dashjs</span>.<span style="color:#a6e22e">MediaPlayer</span>().<span style="color:#a6e22e">create</span>();
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">player</span>.<span style="color:#a6e22e">initialize</span>(document.<span style="color:#a6e22e">querySelector</span>(<span style="color:#e6db74">&#34;#videoPlayer&#34;</span>), <span style="color:#a6e22e">url</span>, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">player</span>.<span style="color:#a6e22e">updateSettings</span>({
</span></span><span style="display:flex;"><span>                  <span style="color:#e6db74">&#39;abr&#39;</span><span style="color:#f92672">:</span>{
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#39;ABRStrategy&#39;</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;abrPada&#39;</span>,
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#39;priority&#39;</span>    <span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>                   }
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>            })();
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><h3 id="data-collection">Data Collection</h3>
<p>The dash player enables the collection of some QoS metrics such as buffer level, throughput, and selected bitrate.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">bufferLevel</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">player</span>.<span style="color:#a6e22e">getBufferLength</span>(<span style="color:#e6db74">&#39;type&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">throughput</span>  <span style="color:#f92672">=</span> <span style="color:#a6e22e">player</span>.<span style="color:#a6e22e">getAverageThroughput</span>(<span style="color:#e6db74">&#39;type&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">quality</span>     <span style="color:#f92672">=</span> <span style="color:#a6e22e">player</span>.<span style="color:#a6e22e">getQualityFor</span>(<span style="color:#e6db74">&#39;type&#39;</span>);
</span></span></code></pre></div><p><code>type</code> denotes the segment type (i.e., video, audio). These metrics along with others can help assess the adaptation algorithm.</p>
<h3 id="adding-modifying-the-pre-recorded-content-adaptation-algorithm">Adding/ modifying the Pre-Recorded Content Adaptation Algorithm</h3>
<p>To be able to add or modify <code>PadaRule.js</code>, you need to do the follwoing steps:</p>
<ol>
<li>Install <a href="http://nodejs.org/">node.js</a>.</li>
<li>Checkout the project repository (<code>git clone https://github.com/traction-project/PreRecordedContentAdaptation.git</code>).</li>
<li>Install dependencies (<code>npm install</code>).</li>
<li>Add or make changes to <code>PadaRule.js</code>.</li>
<li>Build, watch file changes, and launch samples page (<code>npm run start</code>).</li>
</ol>
<h3 id="dashjs-documentation">dash.js Documentation</h3>
<p>Full <a href="http://cdn.dashjs.org/latest/jsdoc/module-MediaPlayer.html">API Documentation</a> is available describing all public methods, interfaces, properties, and events.</p>
<p>For help, join <a href="https://dashif-slack.azurewebsites.net">Slack channel</a> or the <a href="https://groups.google.com/d/forum/dashjs">email list</a>.</p>

  </div>

      </div>
    </section>

    <footer class="footer">
      <div class="is-flex is-justify-content-center">
        <figure class="image is-24x24 mb-4">
          <img src="/images/logo.png">
        </figure>
      </div>

      <div class="content has-text-centered">
        <p class="is-size-6 has-text-weight-light">
          &copy; 2022 <a href="https://traction-project.eu">TRACTION Project</a>.<br/>
          This site is licensed under the <a href="https://github.com/traction-project/traction-project.github.io/tree/master/LICENSE">BSD license</a>.<br/>
          <br/>
          <i>Last update: 2022-12-08</i>
        </p>
      </div>
    </footer>
  </body>
</html>
